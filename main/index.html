<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="google-site-verification" content="3q30uQ1_gO_dEVjUO6EsTgpovt8MHTyY75774HmTSb0">
    <title>පිටක.lk Sinhala Tripitaka</title>
    <meta name="description" content="පාළි ත්‍රිපිටකය හා එහි සිංහල පරිවර්තනය. The Pali Tripitaka and Sinhala Translations of Sri Lanka.">
    <meta property="og:type" content="website"> <!--For facebook link previews -->
    <meta property="og:title" content=""> <!-- will be set by nodejs server -->
    <meta property="og:description" content=""> <!-- will be set by nodejs server -->
    <meta property="og:url" content=""> <!-- will be set by nodejs server -->
    <meta property="og:site_name" content="pitaka.lk">
    <meta property="fb:app_id" content="2497485370370842">
    <meta property="og:image" content="https://pitaka.lk/static/images/og-sarala-500x300.png">
    <meta property="og:image:type" content="image/png">
    <meta property="og:image:width" content="500">
    <meta property="og:image:height" content="300">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Tripitaka">
    <link rel="apple-touch-icon" href="../static/images/app-logo.png">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/png" sizes="96x96" href="../static/images/favicon-96x96.png">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="../static/styles/common_styles.css?v=2" />
    <link rel="stylesheet" href="../static/styles/tree_style.css?v=2" />
    <link rel="stylesheet" href="../main/text_styles.css?v=2" />
    <link rel="stylesheet" href="../static/styles/font-awesome.css?v=1"/>
    <link rel="stylesheet" href="../static/styles/search.css?v=2"/>
    <link rel="stylesheet" href="../static/dialog/multi-select.css?v=1"/>
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-46817481-2', 'auto');
        ga('send', 'pageview');
        window.onerror = function (msg, url, lineNo, columnNo, error) {
            showToast(msg + ' : ' + url + ' : ' + lineNo, 5000);
            return false;
        }
    </script>
    <style>
        i.ss-hide {
            font-style: normal;
        }
        #select-pali-sinhala {
            display: none;
        }
        #select-pali-sinhala.show {
            display: block;
        }
        @media screen and (max-width: 800pt) {
            .pitaka-tree-container {
                position: absolute;
                display: none;
                height: 100%;
                max-width: 100%;
                -webkit-box-shadow: 8px 9px 42px 8px rgba(0,0,0,0.19);
                -moz-box-shadow: 8px 9px 42px 8px rgba(0,0,0,0.19);
                box-shadow: 8px 9px 42px 8px rgba(0,0,0,0.19);
            }
            .pitaka-tree-container .user-opened {
                display: block;
            }
        }
        @media screen and (max-width: 400pt) {
            td.user-closed-coll {
                display: none;
            }
            #select-num-columns {
                display: none;
            }
            #select-pali-sinhala {
                display: block;
            }
            .ss-hide {
                display: none;
            }
        }
        @media screen and (min-width: 400pt) {
            td.force-closed-coll {
                display: none;
            }
        }
    </style>
</head>
<body>

<div style="text-align: center; margin:0 auto; max-width: 1000pt; height: 100%; display: flex; flex-flow: column; overflow: hidden;">

    <div style="flex: 0 1 auto;">
        <div class="title-bar">
            <i id="tree-toggle" class="fa fa-sitemap" tip="සූත්‍ර නාමාවලිය අරින්න වහන්න"></i>
            <div style="flex: 1 1;">ත්‍රිපිටකය</div>
            <i id="menu-toggle" class="fa fa-bars tipright" tip="මෙනුව වෙත පිවිසෙන්න"></i>
        </div>
        <div id="search-bar-div">
            <div id='select-column-buttons' style="display: inherit;">
                <a id="select-pali-sinhala" class="button" tip="පාලි සිංහල අතර මාරු වෙන්න">
                    <b class="pali-cs" style="color: var(--main-color);">පාලි</b>
                    <b class="sinh-aps" style="display: none; color: var(--heading-color);">සිංහල</b>
                </a>
                <a id="select-num-columns" class="button" tip="තනි තීරුව හෝ තීරු දෙකක්ද යන්න"><i class="fa fa-columns fa-fw" style="display: none;"></i><i class="fa fa-window-maximize fa-fw"></i></a>
            </div>
            <input class="search-bar" type="text" placeholder="සොයන්න">
            <a id="search-settings-button" class="button tipright" tip="සෙවුම පොත් කිහිපයකට සීමා කරන්න" onclick="showBookSelectDialog(1)"><i class="fa fa-wrench fa-lg action"></i></a>
            <a id="text-view-button" class="button tipright" tip="සූත්‍ර අන්තර්ගතය වෙත පිවිසෙන්න"><i class="fa fa-file-text-o fa-lg"></i><i class="ss-hide"> අන්තර්ගතය</i></a>
            <a id="bookmark-button" class="button tipright" tip="තරුයෙදූ සූත්‍ර ලැයිස්තුව පෙන්වන්න"><i class="fa fa-star fa-lg" style="color: rgb(228, 194, 0);"></i><i class="ss-hide"> තරුයෙදූ</i></a>
            
            <div id="menu-list" style="right: 0; top: 0;">
                <a class="menu-list-item" href="intro.html?goto=about"><i class="fa fa-male fa-fw"></i> අප ගැන</a>
                <a class="menu-list-item" id="dark-toggle"><span class="lightT"><i class="fa fa-lightbulb-o fa-fw"></i> ආලෝකමත් තිරය</span><span class="darkT"><i class="fa fa-moon-o fa-fw"></i> අඳුරු රාත්‍රී තිරය</span></a>
                <a class="menu-list-item" href="intro.html?goto=usage"><i class="fa fa-question-circle fa-fw"></i> භාවිතයට උපදෙස්</a>
                <a class="menu-list-item" href="intro.html?goto=download"><i class="fa fa-download fa-fw"></i> භාගත කරන්න</a>
                <!--<a class="menu-list-item" href="../"><i class="fa fa-file-text-o fa-fw" style="color: darkgreen;"></i> සරල ත්‍රිපිටකය</a>-->
                <a class="menu-list-item" href="../dict"><i class="fa fa-leaf fa-fw"></i> පාළි-සිංහල ශබ්දකෝෂය</a>
                <a class="menu-list-item" href="https://tipitaka.lk/"><i class="fa fa-book fa-fw"></i> බුද්ධ ජයන්ති ත්‍රිපිටකය</a>
                <a class="menu-list-item" href="https://pitaka.lk/books"><i class="fa fa-pagelines fa-fw"></i> බෞද්ධ පොත් සංචිතය</a>
                <a class="menu-list-item" href="https://pitaka.lk/dhammapada"><i class="fa fa-paw fa-fw"></i> ධම්මපද කතා වස්තු</a>
                <a class="menu-list-item" href="https://www.facebook.com/pitaka.lk"><i class="fa fa-facebook fa-fw"></i> Facebook පිටුව</a>
            </div>
        </div>
    </div>

    <div id="contents-area" style="flex: 1 1 auto; display: flex; flex-flow: row nowrap; position: relative; overflow: auto;" >
        <div class="pitaka-tree-container" style="flex: 0 1 auto;">
            <div class="pitaka-tree"></div>
        </div>

        <div id="search-area" style="flex: 1 1 auto; overflow-y: auto; display: none;">
            <div id="search-status">සෙවීම සඳහා උඩ කොටුවේ නම type කරන්න.</div>
            <div id="search-filter-status"></div>
            <table id="search-results" class="results-table">
                <thead>
                    <tr>
                        <td><i class="fa fa-search fa-fw"></i> ගැළපෙන වචන<span class="sort-action" by="nikaya">
                            <a class="button" tip="නිකාය වැඩිවන පිළිවෙලට පෙළගස්වන්න" order="asc"><i class="fa fa-sort-alpha-asc fa-fw"></i></a>
                            <a class="button" tip="නිකාය අඩුවන පිළිවෙලට පෙළගස්වන්න" order="desc"><i class="fa fa-sort-alpha-desc fa-fw"></i></a></span>
                        </td>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>

        <div id="bookmark-area" style="flex: 1 1 auto; overflow-y: auto; display: none;">
            <div id="bookmark-status"></div>
            <table id="bookmark-list" class="results-table">
                <tbody></tbody>
            </table>
        </div>

        <div id="text-view-area" class="text-section" style="flex: 1 1 ; overflow-y: auto; padding: 2pt; position: relative;">
            <table id="text-view-table">
                <tbody id="text-view-tbody"></tbody>
            </table>
        </div>

    </div>
</div>

<div id="toast"></div>

<!-- dialog box -->
<div id="dialog-overlay" onclick="closeDialog()"></div>
<div id="dialog-box">
    <div class="dialog-content">
        <div id="dialog-message"></div>
    </div>
</div>

<script src="../static/scripts/jquery-3.4.1.min.js"></script>
<script src="../static/scripts/css-vars-ponyfill@2.js"></script> <!-- Android 4 does not support css vars -->
<script src="../static/scripts/underscore-min.js"></script>
<script src="../static/scripts/clipboard.min.js"></script>
<script src="../static/scripts/vkbeautify.js"></script>
<script src="../static/scripts/utilities.js?v=1"></script>
<script src="../static/scripts/singlish.js?v=1"></script>
<script src="../static/scripts/pitakaTree.js?v=1"></script>
<script src="../main/search.js?v=1"></script>
<script src="../main/pitakaTable.js?v=1"></script>
<script src="../static/dialog/jquery.multi-select.js?v=1"></script>
<script src="../static/dialog/dialog_select_book.js?v=1"></script>
<script>
    cssVars({});
    var userCloseColl = ''; // will be set when text is loaded
    var numOpenedColls = 2;
    function showSearchArea() {
        console.log('show search area');
        $('#search-area, #search-settings-button').show();
        $('#text-view-area, #select-column-buttons').hide();
        $('#bookmark-area').hide();
    }
    function showTextArea() {
        console.log('show text area');
        $('#search-area, #search-settings-button').hide();
        $('#text-view-area, #select-column-buttons').show();
        $('#bookmark-area').hide();
    }
    function showBookmarkArea() {
        console.log('show bookmark area');
        $('#search-area, #search-settings-button').hide();
        $('#text-view-area, #select-column-buttons').hide();
        $('#bookmark-area').show();
    }
    function openLocationFromUrl() { // only used in the android app
        // set startup location if specified in url params
        var location = getStartupLocation();
        if (!location) {
            showSearchArea();
        } else if ($('.text-view-tbody').is(':empty')) { // text not already loaded by server
            pitakaLkOpenLocation(location, 'startup');
        } else { // loaded from server
            userCloseColl = 'pali-cs';
        }
    }

    $( document ).ready( function() {
        console.log('OS detected: ' + getOS());
        $('.pitaka-tree').load('../main/text/main_toc_full.xml', function () {
            $(this).pitakaTree();
            openLocationFromUrl(); // for android when site links are opened with the app
        });

        $('#menu-toggle').mousedown(function (e) {
            $('#menu-list').animate({height: 'toggle'}, 200);
            e.stopPropagation();
        });
        $('#tree-toggle').mousedown(function(e) {
            $('.pitaka-tree-container').animate({width: 'toggle'}, 250);
            $('.pitaka-tree-container').toggleClass('user-opened');
            e.stopPropagation();
        });
        $('#menu-list, .pitaka-tree-container').mousedown(function(e) {
            e.stopPropagation();
        });
        $('body').mousedown(function() {
            $('#menu-list').animate({height: 'hide'}, 350);
            if ($('.pitaka-tree-container').css('position') == 'absolute') { // hide the tree if it is overlapping
                $('.pitaka-tree-container').animate({width: 'hide'}, 250);
            }
        });

        $('#select-num-columns').click(function(e) {
            if (!userCloseColl) return;
            numOpenedColls = (numOpenedColls == 2) ? 1 : 2;
            $(this).children().toggle();
            if (numOpenedColls == 2) {
                $('#select-pali-sinhala').removeClass('show');
                $('#text-view-tbody td').removeClass('force-closed-coll');
            } else { // one column
                $('#select-pali-sinhala').addClass('show');
                $('#text-view-tbody td.user-closed-coll').addClass('force-closed-coll');
            }
        });
        $('#select-pali-sinhala').click(function(e) {
            if (!userCloseColl) return;
            userCloseColl = (userCloseColl == 'pali-cs') ? 'sinh-aps' : 'pali-cs';
            $('#text-view-tbody td').toggleClass('user-closed-coll');
            if (numOpenedColls == 1) {
                $('#text-view-tbody td.user-closed-coll').addClass('force-closed-coll');
                $('#text-view-tbody td:not(.user-closed-coll)').removeClass('force-closed-coll');
            }
            $(this).children().toggle();
        });

        $.fn.registerTextClicks();

        function handleResize() {
            // to make sure the overlay fills the screen and dialogbox aligned to center
            // only do it if the dialog box is not hidden
            if (!$('#dialog-box').is(':hidden')) repositionDialog();
        }
        $(window).resize(handleResize);

        $('#text-view-button').click(function (e) {
            showTextArea();
        });
        $('#bookmark-button').click(function (e) {
            displayBookmarks();
            showBookmarkArea();
        });
        $('.search-bar').focus(function (){
            showSearchArea();
        });
        $('span.sort-action').on('click', 'a', function () {
            var by = $(this).parent().attr('by');
            var order = $(this).attr('order');
            refreshCurrentSearchDisplay(by, order);
        });

        $('[tip]').hover(showToolTip, hideToolTip);

        window.addEventListener("popstate", function(e) {
            if (window.historyInitiated) { // in ios initial load also fires this event. set in pitakaTable setMetaTags
                window.historyPopped = true; // do not add this reload to the history
                openLocationFromUrl();
            }
        });
        autoSetDarkMode();
        
        // do this at the end due to index pre-fetching
        initSearchBar();
    });
</script>
</body>
</html>